<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Cory Merow, Adam Wilson" />


<title>Incorporating Expert Range Maps in SDMs</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="cm_yeti_bootswatch.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecology, Statistics, and Data Science with R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Head2_Schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Intro
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Head1_CourseContent.html">About Course Content</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 1: Introduction to R</li>
    <li>
      <a href="00_CourseIntroductionFrame.html">1.0 Course Introduction</a>
    </li>
    <li>
      <a href="01_Rintro.html">1.1 First Steps</a>
    </li>
    <li>
      <a href="02_DataWrangling.html">1.2 Data Wrangling</a>
    </li>
    <li>
      <a href="03_Plotting.html">1.3 Plotting</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 2: Spatial Analyses</li>
    <li>
      <a href="04_Spatial.html">2.1 Spatial Data</a>
    </li>
    <li>
      <a href="05_Raster.html">2.2 Spatial Raster Data</a>
    </li>
    <li>
      <a href="06_RasterTwo.html">2.3 More Raster Data</a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ecoinformatics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="3_1_Ecoinf_Schedule.html">0 Workshop Schedule</a>
    </li>
    <li>
      <a href="3_8_BIEN_Intro.html">1 (BIEN) Botanical Information and Ecology Network</a>
    </li>
    <li>
      <a href="3_7_TNRS.html">2 Taxonomic Name Resolution</a>
    </li>
    <li>
      <a href="3_3_RBIEN_tutorial.html">3 Accessing Plant Biodiversity Data</a>
    </li>
    <li>
      <a href="3_4_wallace.html">4 A streamlined modeling workflow: Wallace</a>
    </li>
    <li>
      <a href="3_5_Minxent.html">5 Integrating biogeographic data </a>
    </li>
    <li>
      <a href="3_2_Networks.html">6 Network Associations</a>
    </li>
    <li>
      <a href="3_6_Teaching_Ecoinformatics.html">7 Teaching Econformatics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ecological Modeling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Under_Construction.html">Under Construction</a>
    </li>
  </ul>
</li>
<li>
  <a href="Head3_Resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cmerow/RDataScience/tree/gh-pages">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Incorporating Expert Range Maps in SDMs</h1>
<h4 class="author"><em>Cory Merow, Adam Wilson</em></h4>

</div>


<div>
<object data="3_5_assets/Minxent_Short.pdf" type="application/pdf" width="100%" height="650px">
<p>
It appears you don’t have a PDF plugin for this browser. No biggie… you can <a href="3_5_assets/Minxent_Short.pdf">click here to download the PDF file.</a>
</p>
</object>
</div>
<p>
<a href="3_5_assets/Minxent_Short.pdf">Download the PDF of the presentation</a>
</p>
<p><a href="3_5_Minxent.R"><i class="fa fa-file-code-o fa-3x" aria-hidden="true"></i> The R Script associated with this page is available here</a>. Download this file and open it (or copy-paste into a new script) with RStudio so you can follow along.</p>
<div id="setup" class="section level1">
<h1><span class="header-section-number">1</span> Setup</h1>
<div id="load-necessary-libraries" class="section level2">
<h2><span class="header-section-number">1.1</span> Load necessary libraries</h2>
<pre class="r"><code>library(ggplot2)
library(foreach)
registerDoSEQ()
library(dplyr)
library(tidyr)
library(bossMaps)
library(raster)</code></pre>
<div id="load-example-data-for-the-solitary-tinamou" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Load example data for the Solitary Tinamou</h3>
<pre class="r"><code>species=c(&quot;Tinamus_solitarius&quot;)

data(&quot;Tinamus_solitarius_points&quot;)
data(&quot;Tinamus_solitarius_range&quot;)
data(&quot;Tinamus_solitarius_env&quot;)

points=Tinamus_solitarius_points
range=Tinamus_solitarius_range
env=Tinamus_solitarius_env</code></pre>
</div>
</div>
</div>
<div id="calculate-priors" class="section level1">
<h1><span class="header-section-number">2</span> Calculate Priors</h1>
<div id="calculate-range-distances" class="section level2">
<h2><span class="header-section-number">2.1</span> Calculate range distances</h2>
<div class="well">
<p>Calculate the distance between expert range edge and all cells on the map (useful for estimating how likelihood of the species should decay as you get further from the expert map).</p>
<button data-toggle="collapse" class="btn btn-primary btn-sm round" data-target="#demo1">
Kind of a digression….
</button>
<div id="demo1" class="collapse">
<pre class="r"><code>rdist = rangeDist(
  range = range,
  points = points,
  domain = env,
  domainkm = 1000,
  mask = F,
  fact = 2
  )</code></pre>
<pre><code>## Rasterizing range to ROI
## Calculating distances
## Resampling back to original resolution</code></pre>
<pre class="r"><code>## Crop environmental data to this new domain (based on domainkm)
env_domain = crop(env, rdist)

## Mask pixels with no environmenta data (over ocean, etc.)
rdist = mask(rdist, env_domain[[1]])
names(rdist) = &quot;rangeDist&quot;</code></pre>
</div>
</div>
<p>This is the result:</p>
<pre class="r"><code>plot(rdist)</code></pre>
<pre><code>## NOTE: rgdal::checkCRSArgs: no proj_defs.dat in PROJ.4 shared files
## NOTE: rgdal::checkCRSArgs: no proj_defs.dat in PROJ.4 shared files
## NOTE: rgdal::checkCRSArgs: no proj_defs.dat in PROJ.4 shared files</code></pre>
<pre class="r"><code>plot(range, add = T)
plot(points, add = T)</code></pre>
<p><img src="3_5_Minxent_files/figure-html/unnamed-chunk-5-1.png" /><!-- --></p>
</div>
<div id="evaluate-curves-describing-expert-accuracy-beyond-the-expert-map-boundaries" class="section level2">
<h2><span class="header-section-number">2.2</span> Evaluate curves describing expert accuracy beyond the expert map boundaries</h2>
<div class="well">
<p>Calculate which curve parameter combinations are feasible given the domain and range geometry.</p>
<button data-toggle="collapse" class="btn btn-primary btn-sm round" data-target="#demo2">
Kind of a digression….
</button>
<div id="demo2" class="collapse">
<pre class="r"><code>rates=checkRates(rdist)</code></pre>
<pre><code>## Calculating the range distance frequency table, you can also provide this with the dists parameter.
## Fitting the expert range decay, this can take a while depending on how many values you selected...</code></pre>
<p><img src="3_5_Minxent_files/figure-html/unnamed-chunk-6-1.png" /><!-- --></p>
<p>From these, choose a few</p>
<pre class="r"><code>vars=expand.grid(
  prob=c(0.5, 0.7, 0.9),
  rate=c(0,0.01,0.1,10),
  skew=0.5,
  shift=0,
  stringsAsFactors=F)
x=seq(-150,500,len=1000)</code></pre>
<p>Calculate all the curves</p>
<pre class="r"><code>uvars=unique(vars[,c(&quot;rate&quot;,&quot;skew&quot;,&quot;shift&quot;)])
erd=do.call(rbind,
            lapply(1:nrow(uvars),function(i) {
              y=logistic(x,
                         parms=unlist(c(lower=0,upper=1,uvars[i,])))  
              return(cbind.data.frame(
                group=i,
                c(uvars[i,]),
                x=x,
                y=y))
            })
)  </code></pre>
<p>Visualize potential decay parameters</p>
<pre class="r"><code>ggplot(erd,
       aes(
       x = x,
       y = y,
       linetype = as.factor(skew),
       colour = as.factor(rate),
       group = group
       )) +
       geom_vline(aes(xintercept = 0), colour = &quot;red&quot;) +
       geom_line() +
       xlab(&quot;Prior value (not normalized)&quot;) +
       xlab(&quot;Distance to range edge (km)&quot;)</code></pre>
<p><img src="3_5_Minxent_files/figure-html/unnamed-chunk-9-1.png" /><!-- --></p>
</div>
</div>
</div>
<div id="build-priors" class="section level2">
<h2><span class="header-section-number">2.3</span> Build priors</h2>
<div class="well">
<p>Calculate the priors and project them across the landscape as rasters.</p>
<button data-toggle="collapse" class="btn btn-primary btn-sm round" data-target="#demo3">
Kind of a digression….
</button>
<div id="demo3" class="collapse">
<p>Calculate frequency table of distances: In order to speed up optimization of range offsets, we calculate the <code>rangeOffset()</code> on a frequency distribution instead of the full raster. Calculate that now with <code>freq()</code>.</p>
<pre class="r"><code>dists = freq(rdist, useNA = &quot;no&quot;, digits = 2)
knitr::kable(head(dists))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">value</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-289.97</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">-289.50</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">-288.72</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">-288.45</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">-280.91</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">-280.47</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>mcoptions &lt;- list(preschedule = FALSE, set.seed = FALSE)
foreach(i = 1:nrow(vars), .options.multicore = mcoptions) %do% {
  ## calculate the expert range prior
  fo = paste0(species, &quot;_prior_&quot;, paste(vars[i, ], collapse = &quot;_&quot;), &quot;.grd&quot;)
  if (file.exists(fo))  return(NULL)
  expert = rangeOffset(
                      rdist,
                      parms = unlist(vars[i, ]),
                      dists = dists,
                      doNormalize = T,
                      verbose = T,
                      doWriteRaster = T,
                      filename = fo,
                      overwrite = T,
                      datatype = &quot;FLT4S&quot;
                      )
}</code></pre>
</div>
</div>
</div>
<div id="stack-the-priors" class="section level2">
<h2><span class="header-section-number">2.4</span> Stack the priors</h2>
<p>Here’s where we’ll pick up the analysis, assuming you’ve somehow created a reasonable prior already (unfold code above for an example with expert maps). Priors for your analyses might come from sampling bias models, maps of related species, or expert maps, among many other possibilities (Merow et al. 2016 GEB).</p>
<pre class="r"><code>fs = list.files(pattern = &quot;prior.*grd$&quot;,
                full = T,
                recursive = F)
                
priors = stack(fs)
                
## build prior table from metadata
priorf = foreach(i = 1:nlayers(priors), 
                 .combine = bind_rows) %do% {
  t1 = metadata(priors[[i]])
  t2 = t1$parms
  names(t2) = t1$pnames
  return(data.frame(id = i, t(t2)))
  }

names(priors) = paste0(&quot;prior&quot;, priorf$id)#basename(fs[wp])
plot(priors)</code></pre>
<p><img src="3_5_Minxent_files/figure-html/unnamed-chunk-12-1.png" /><!-- --></p>
</div>
</div>
<div id="maxentpoisson-point-process-sdm" class="section level1">
<h1><span class="header-section-number">3</span> MaxEnt/Poisson Point Process SDM</h1>
<div id="assemble-modeling-dataset" class="section level2">
<h2><span class="header-section-number">3.1</span> Assemble modeling dataset</h2>
<pre class="r"><code>## build single raster stack of all needed data (env and priors)
rdata = stack(env, priors)

## generate presence and non-detection datasets
pres = cbind.data.frame(
  presence = 1, 
  raster::extract(rdata, points, df =
  T, ID = F))
ns = 10000
abs = cbind.data.frame(
  presence = 0,
  ID = 1:ns,
  sampleRandom(rdata, ns))</code></pre>
<pre><code>## NOTE: rgdal::checkCRSArgs: no proj_defs.dat in PROJ.4 shared files</code></pre>
<pre class="r"><code>data = rbind.data.frame(
  pres, 
  abs)</code></pre>
</div>
<div id="fit-models" class="section level2">
<h2><span class="header-section-number">3.2</span> Fit models</h2>
<p>You can fit a maxent-style model or Poisson point process with <code>glm()</code> simply by applying weights to the data. See the appendix of Renner et al. 2015 (Point process models for presence-only analysis; GEB) for details on why this works. Note that I’m not fitting all the flexible functional forms of a maxent model; this is equivalent to turning off threshold and hinge features and note using regularization.</p>
<pre class="r"><code>data$weight = 1e-6
best.var = names(env)

# number of non-NA cells
nc = cellStats(!is.na(priors[[1]]), sum)</code></pre>
<pre><code>## NOTE: rgdal::checkCRSArgs: no proj_defs.dat in PROJ.4 shared files
## NOTE: rgdal::checkCRSArgs: no proj_defs.dat in PROJ.4 shared files</code></pre>
<pre class="r"><code>data$weight[data$presence == 0] = nc / sum(data$presence == 0)

## Set up models
formulas = paste(
  &quot;presence/weight ~&quot;,
  &quot; offset(log(&quot;,
  grep(&quot;prior&quot;, 
       colnames(data),
       value = T),&#39;))+&#39;,
  paste0(sapply(
    best.var, function(ii) {
      sapply(best.var, function(jj) {
        paste0(ii, &quot;*&quot;, jj)
    })
  }), collapse = &#39;+&#39;),
  &#39;+&#39;,
  paste0(&#39;I(&#39;, best.var, &#39;^2)&#39;, collapse = &#39;+&#39;),
  &#39;+&#39;,
  paste0(best.var, collapse = &#39;:&#39;)
)

formulas[1]</code></pre>
<pre><code>## [1] &quot;presence/weight ~  offset(log( prior1 ))+ bio1*bio1+bio1*bio12+bio12*bio1+bio12*bio12 + I(bio1^2)+I(bio12^2) + bio1:bio12&quot;</code></pre>
<pre class="r"><code>mods = foreach(f = formulas) %do% {
  glm(
    as.formula(f),
    family = poisson(link = log),
    data = data,
    weights = weight
  )
}</code></pre>
<p>Calculate AIC</p>
<pre class="r"><code>priorf$AIC=unlist(lapply(mods,function(x) AIC(x)))</code></pre>
</div>
<div id="make-spatial-predictions" class="section level2">
<h2><span class="header-section-number">3.3</span> Make spatial predictions</h2>
<pre class="r"><code>mcoptions &lt;- list(preschedule = FALSE, set.seed = FALSE)

ptype = &quot;response&quot;
psi = 1:nrow(priorf)

ps = foreach(i = psi, 
  .options.multicore = mcoptions) %dopar% {
    fo = paste0(
      species,&quot;_posterior_&quot;,
      priorf$prob[i],&quot;_&quot;,
      priorf$rate[i],&quot;_&quot;,
      priorf$skew[i],&quot;_&quot;,
      priorf$shift[i],
      &quot;.grd&quot;
      )
  if (file.exists(fo))
    return(NULL)
  #if(!file.exists(fo)) return(&quot;NOT YET&quot;)
  normalize(
    raster::predict(
      rdata,
      mods[[i]],
      type = ptype),
    file = fo,
    overwrite = T)
}</code></pre>
<pre><code>## Warning: executing %dopar% sequentially: no parallel backend registered</code></pre>
<pre class="r"><code>psf = list.files(pattern = &quot;posterior.*.grd&quot;, full = T)
ps = stack(psf)
names(ps) = sub(&quot;prior&quot;, &quot;posterior&quot;, names(priors)[psi])</code></pre>
</div>
<div id="predictions-maps-for-different-priorsoffesets" class="section level2">
<h2><span class="header-section-number">3.4</span> Predictions maps for different priors/offesets</h2>
<!-- fig.cap=fig$cap('preds','Predictions for different expert map smoothing parameters.', col="blue"), fig.align="center"} -->
<p>The first column corresponds to a maxent prediction without an offset/prior (so those are are the same). Note that those models have the worst AIC compared to any of the other models, which incorporate the expert map. Figuring out which of the expert map priors is best will require some evaluation of the expert’s typical accuracy, e.g. across a taxonomic group. That’s the next phase of analysis… <img src="3_5_Minxent_files/figure-html/predplot-1.png" /><!-- --></p>
<!-- # not working figure caption code -->
<!-- # ```{r, fig.cap=fig$cap("cos_wav", "Cosine curve", col="red"), fig.align="center"} -->
<!-- # par(mar=c(2.5, 2.5, 0.5, 0.5)); plot(x=0:100*pi/50, y=cos(0:100*pi/50), cex=0.5, xlab="x", ylab="cos(x)") -->
<!-- # ``` -->
</div>
</div>


<!-- give the footer some space -->
<br/>
<br/>

<footer id="site-footer">
  <div id="footer1">
  <a href="https://cmerow.github.io"><img src="img/cory.png" alt="logo" width=40px></a>
  <!--
  <a href="http://adamwilson.us/#contact"><i class="fa fa-envelope fa-2x"></i></a> 
  <a href="https://twitter.com/AdamWilsonLab"><i class="fa fa-twitter fa-2x"></i></a> 
  <a href="https://github.com/AdamMWilson"><i class="fa fa-github fa-2x"></i></a>
  -->
  </div>
  <div id="footer2">
  <a rel="license" property="http://creativecommons.org/ns#license"
  href="http://creativecommons.org/licenses/by/4.0/" ><img src="img/cc-by.svg" alt="cc-by"/></a> 
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
